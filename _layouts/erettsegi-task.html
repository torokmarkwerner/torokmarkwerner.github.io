---
layout: default
---
<script src="/erettsegi/buttons.js">
</script>
<script src="/erettsegi/pick-drop-isvisible.js">
</script>
<script src="/erettsegi/create-task.js">
</script>
<style>
	#feedback-form label, #feedback-form input {
    display: block;
    margin: auto;
    width: 80%;
    padding: 0.5em;
    text-align: left;
}

#feedback-form label {
  text-align: center;
}

#feedback-form input, #feedback-form div {
  background: whitesmoke;
  border: 1pt black solid;
  padding:0.5em;
  margin-bottom: 1em;
}

#feedback-form div {
  width: fit-content;
  display: inline-block
}

#form-button {
    font-variant-caps: all-small-caps;
    padding: 1em;
    margin: 0.5em;
    border: 0pt;
    background: palegreen;
}

#form-button:hover {
  opacity: 0.9;
  cursor: pointer
}
</style>

<script>
function submitReport() {
	form = document.getElementById("feedback-form");

task = '{{ page.permalink | replace: "/erettsegi/", "" | replace: "/", "-" }}' + document.getElementById("form-task").querySelector(":checked").innerText.replace("Task ","");

problem = document.getElementById("form-problem").value;

suggestions = document.getElementById("form-suggestions").value;

if (task != "" && problem != "" && suggestions != "") {

/*
document.getElementById("form-problem").classList.remove("missing");
document.getElementById("form-suggestions").classList.remove("missing");
*/
	
	document.getElementById("form-error").style.display = "none";

fetch("https://docs.google.com/forms/d/e/1FAIpQLSc1czG7t66kGNB1I_Q3RWhN1aGq6YeuWUtxhVabWqkrE3dFvQ/formResponse?usp=pp_url&entry.874135683=" + encodeURIComponent(task) + "&entry.1089027598=" + encodeURIComponent(problem) + "&entry.271003357=" + encodeURIComponent(suggestions))

document.getElementById("form-button").disabled = true;
document.getElementById("form-button").innerHTML = "Elküldve";

} else {
	document.getElementById("form-error").style.display = "block";

/*	if (problem == "") {
document.getElementById("form-problem").classList.add("missing");
	} 

	if (suggestions == "") {
document.getElementById("form-suggestions").classList.add("missing");
	}
	*/
}
}

	function showReportModal() {
reportFormData = [["form-task","Melyik feladatot érinti a hiba?"],["form-problem","Mi a probléma?"],["form-suggestions","Milyen javaslataid vannak még?"]]

		form = document.createElement("FORM");
		form.id = "feedback-form";
		h2 = document.createElement("H2");
		h2.innerHTML = "Visszajelzési űrlap*";
		form.appendChild(h2)

error = document.createElement("P");
error.id = "form-error"
error.innerHTML = "Töltse ki az összes mezőt!";
error.style.display = "none";
error.style.color = "red";

form.appendChild(error)

		for (i=0;i<reportFormData.length;i++) {
label = document.createElement("LABEL");
label.for = reportFormData[i][0];
label.innerHTML = reportFormData[i][1];
form.appendChild(label)
if (i==0) {
div = document.createElement("DIV");
span = document.createElement("SPAN");
span.innerHTML = '{{ page.permalink | replace: "/erettsegi/", "" | replace: "/", " | " }}'
div.appendChild(span)
		select = document.createElement("SELECT");
		select.id = reportFormData[i][0]
		h2s = document.getElementById("content-container").getElementsByClassName("task-title");
		for (z=0; z<h2s.length; z++) {
			option = document.createElement("OPTION");
			option.innerHTML = h2s[z].innerText.replace("SRCKEY","");
			select.appendChild(option);
		}
div.appendChild(select)	
form.appendChild(div)
} else {
	input = document.createElement("INPUT");
	input.type = "text";
	input.id = reportFormData[i][0];
	form.appendChild(input)
}
		}

p = document.createElement("P");
p.innerHTML = '*A jelen űrlap anonim, személyes adatokat nem kell megadnia.<br> Az űrlap a <a href="https://policies.google.com/" target="_blank">Google Űrlapok adatvédelmi irányelvei</a> szerint működik.';
p.style.fontSize = "x-small";

form.appendChild(p)

button = document.createElement("BUTTON");
button.id = "form-button";
button.innerHTML = "Küldés";

button.addEventListener("click",submitReport)

document.querySelector("#score-modal p").innerHTML = ""
document.querySelector("#score-modal p").appendChild(form)
document.querySelector("#score-modal p").appendChild(button)

document.querySelector("#score-modal").parentElement.style.display = "flex";

	}
</script>

<button id="report-button">Report</button>

<script>
{% if page.task_id %}
{% assign taskids = page.task_id | split: "," %}
{% else %}
{% assign taskids = "" | split: "," %}
{% assign tasks = site.pages | where_exp: "item" , "item.url contains page.permalink" | where_exp: "item" , "item.url != page.url" | sort: "path" %}
{% for task in tasks %}
{% if task.url != page.url %}
{% assign taskids = taskids | push: task.task_id %}
{% endif %}
{% endfor %}
{% endif %}

{% for taskid in taskids %}
createTask("{{ taskid }}");
{% endfor %}

document.getElementById("report-button").addEventListener("click",showReportModal)

</script>