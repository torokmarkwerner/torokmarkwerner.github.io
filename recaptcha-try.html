  <head>
    <title>reCAPTCHA demo: Simple page</title>
     <script src="https://www.google.com/recaptcha/api.js" async defer></script>
     <script>
       function callback_recap(token) {
         document.getElementById("demo-form").submit();
         var xhr = new XMLHttpRequest();
         xhr.open('POST', "https://script.google.com/macros/s/AKfycbxCcYzGfxqpEruWnrNDr6qylHfieOde_rN7ijpUaY2xXgNqODl21t6DtwTzOjSxNHW-pQ/exec", true);
         xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
         xhr.send('name=' + document.getElementById("name").value + "&g-recaptcha-response=" + token);
  
         /*var xhttp = new XMLHttpRequest();
xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
       // Typical action to be performed when the document is ready:
       alert(xhttp.responseText);
    }
};
xhttp.open("GET", "https://script.google.com/macros/s/AKfycbxCcYzGfxqpEruWnrNDr6qylHfieOde_rN7ijpUaY2xXgNqODl21t6DtwTzOjSxNHW-pQ/exec?g-recaptcha-response=" + token, true);
xhttp.send();*/
       }
     </script>
  </head>
  <body>
    <form id='demo-form'>
        Name: <input id="name" type="text" name="name"><br>
<button class="g-recaptcha" data-sitekey="6Ld802sgAAAAABSZiOb1YDO0ApjEkmx4PNVh03tM" data-callback='callback_recap' data-action='contact'>Send</button>
    </form>
</body>
