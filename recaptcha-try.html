  <head>
    <title>reCAPTCHA demo: Simple page</title>
     <script src="https://www.google.com/recaptcha/api.js" async defer></script>
     <script>
       function isEmpty() {
         fields = document.getElementsByClassName("required-fields");
         for (i=0; i<fields.length; i++) {
           if (fields[i].value === "") {
             alert("Please fill in the required fields.")
             return false
           }
         }
       }
       function onSubmit(token) {
         //document.getElementById("demo-form").submit();
         var xhr = new XMLHttpRequest();
         xhr.open('POST', "https://script.google.com/macros/s/AKfycbxCcYzGfxqpEruWnrNDr6qylHfieOde_rN7ijpUaY2xXgNqODl21t6DtwTzOjSxNHW-pQ/exec", true);
         xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
         xhr.send('name=' + document.getElementById("name").value + "&g-recaptcha-response=" + token + "&email=" + document.getElementById("email").value + "&message=" + document.getElementById("message").value);
  
         /*var xhttp = new XMLHttpRequest();
xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
       // Typical action to be performed when the document is ready:
       alert(xhttp.responseText);
    }
};
xhttp.open("GET", "https://script.google.com/macros/s/AKfycbxCcYzGfxqpEruWnrNDr6qylHfieOde_rN7ijpUaY2xXgNqODl21t6DtwTzOjSxNHW-pQ/exec?g-recaptcha-response=" + token, true);
xhttp.send();*/
       }
     </script>
  </head>
  <body>
    <form id='demo-form' >
        Name: <input class="required-fields" id="name" type="text" name="name" required><br>
      Email: <input class="required-fields" id="email" type="text" name="name" required><br>
      Message: <input class="required-fields" id="message" type="text" name="name" required><br>
<input class="g-recaptcha" data-sitekey="6Ld802sgAAAAABSZiOb1YDO0ApjEkmx4PNVh03tM" data-callback='onSubmit' type="submit" data-action='submit' value="Send">
    </form>
</body>
