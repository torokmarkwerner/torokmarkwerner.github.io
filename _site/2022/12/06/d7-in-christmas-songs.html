<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>



TM | D⁷ in Christmas songs
</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.png?">
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
  </head>
  <style>
#search-button:hover {
  opacity: 0.9;
  cursor:pointer;
}
.abc-parantheses {
  counter-reset: abc;
}
.abc-parantheses > li {
  list-style: none;
  padding: 0.5em 0
}
.abc-parantheses > li:before {
  content: counter(abc, lower-alpha) ") ";
  counter-increment: abc;
}
.language {
    display: inline;
    }
.language a {
  border: 2pt solid black;
  margin: 0 -1em;
  background: black;
  display: inline-block;
  color: black;
  clip-path: circle(30%);
}
.language img {
  vertical-align: middle;
  width: 4em;
  clip-path: circle(30%);
}
  summary {
      color:crimson;
      font-weight:bold
    }
    summary:hover {
      cursor:pointer;
      opacity:0.9
    }
    #rating-container2 {
      max-width:100px;
    }
    #rating-container {
      padding:0;
      margin:0;
      position:relative;
      font-size:150%;
      width:100%;
      }
    
    #rating-basic-stars {
      padding:0;
      margin:0;
      color: grey;
      position: relative;
      width: 100%;
      overflow:hidden;
    }
    
    #rating-rating {
      padding:0;
      margin:0;
      color: orange;
      position: absolute;
      top: 0;
      left: 0;
      width: calc(100% * var(--rate)/5);
      overflow:hidden;
    }
    .rating-scoretable {
      display:none;
      padding: 0.5em 0;
      table-layout:fixed;
      width:100%;
      text-align:center;
    }
    .rating-scoretable td {
      border: 1px black solid;
      height:2em
    }
    .rating-scoretable th {
      color:white;
      font-weight: normal;
      background-color:black;
    }
    </style>
<style>
  .pages-button {
    text-decoration: none;
    color: inherit;
    display: block;
  }
    .video-container {
      position: relative;
      padding-bottom: 56.25%;
      height: 0;
      overflow: hidden;
      }
    
    .video-container iframe, .video-container object, .video-container embed { 
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      }
</style>
<style>
  acronym[title] {
    text-decoration-thickness: from-font;
    text-underline-position: from-font;
  }
  html, body { height: 100%; }
  .toc {
    background-color: lemonchiffon;
    padding: 1em;
    min-width:50%;
    width:fit-content;
    font-variant-caps: petite-caps;
  }
  .toc div {
    padding-top: 0.5em;
    font-weight: bold;
    text-align:center;
  }
  .toc ul {
    padding-inline-start: 1em;
    padding-inline-end: 1em;
    margin-block-start: 1em;
    margin-block-end: 0em;
    list-style: none;
  }
  .toc li {
    padding-bottom:1em
  }
  .toc li a {
    text-decoration: none;
  }

#content-container h2 {
  padding-top:0.5em
  }
 
  .highlighted-text {
    background-color: antiquewhite;
    padding: 0.5em;
    font-size: 115%;
    font-weight: bold;
    display:block;
  }
  #content-container img:not(.related-post-image) {
    max-width: 100%
  }
  .examples table {
  border-collapse:collapse
  }
  .examples td {
  padding: 0.5em;
  border:0.5px black solid
  }
  .examples tr td:nth-child(1) {
  min-width:fit-content;
  text-align:center;
  }
  .examples {
  counter-increment: my-sec-counter;
  counter-reset: my-sec-counter2;
}

.examples ol {
counter-reset: my-sec-counter2;
list-style-type: none;
display:table;
border-collapse: separate;
border-spacing: 0.5em;
padding:0.5em 2em 0.5em 2em;
padding-inline-start: 0;
}

.examples ol li {
display: table-row;
}

.examples ol li::before {
  counter-increment: my-sec-counter2;
  content: counter(my-sec-counter) counter(my-sec-counter2, upper-alpha) " ";
  display:table-cell;
  text-align:left;
  width:2em;
  vertical-align:middle;
}
::-moz-selection { /* Code for Firefox */
  color: HighlightText;
  background: Highlight;
}
::selection {
  color: HighlightText;
  background: Highlight;
}
.tag-name {
  color: chocolate;
  font-weight: bold;
  text-decoration: none;
  }
.tag-name:hover {
  opacity:0.9
  }
.post-title {
    display: inline-block;
    background-color: lightgoldenrodyellow;
    color: black;
    text-decoration: none;
    padding: 0.5em;
  }
.post-title:hover {
  background-color: antiquewhite;
  opacity:0.9;
  }
.fa.fa-facebook, .fa.fa-google, .fa.fa-linkedin {
 font-size: 20px;
 width: 40px;
 height: 40px;
 line-height: 40px;
  text-align: center;
  text-decoration: none;
  margin: 0.5em 0.2em;
  border-radius:5px;
  }
  .fa.fa-facebook:hover, .fa.fa-google:hover, .fa.fa-linkedin:hover {
    cursor:pointer;
    opacity: 0.7;
}

.fa-facebook {
  background: #3B5998;
  color: white;
}

.fa-google {
  background: #dd4b39;
  color: white;
}

.fa-linkedin {
  background: #007bb5;
  color: white;
}
</style>
  <style>
body {
  font-family: "Calibri", "Arial", sans-serif;
  margin: 0;
  border: 0;
  padding:0;
    width:100%;
  overflow-y: scroll;
  }
.page-wrapper {
  width:80vw;
  display:flex;
  min-height:100%;
  height:fit-content;
  margin-left: 10vw;
  margin-right: 10vw;
  padding-top:10px
}
#sticky {
  text-align:center;
  width:20vw;
    position: sticky;
    top: 10px;
    align-self: flex-start;
}
.pages-button {
  font-size:125%;
  padding: 0.5em;
}
.pages-button:hover {
  background-color:lightskyblue;
  cursor:pointer;
  font-weight:bold;
}
.pages-button-current {
      background-color:palegreen;
      
    }
#content-container {
      padding:0 0 0 2em;
      width:40vw
    }
    
@media (max-width: 767px) {
    .sticky {
      display:none;
    }
    #content-container {
      width:80vw;
    }
  }
    
</style>

<body>
<div class="page-wrapper">
  <div id="background" style="opacity:0.8;width:100%;height:100%;background-color:black;top:0;left:0;position:fixed;display:none;z-index:2">
</div>

<style>
#hamburger {
  display: none;
  }
  
#sticky img {
  width: 100%;
  }
#close {
  display: none;
  }
@media (max-width: 767px) {
#hamburger {
    display: block;
    position: fixed;
    background: lightskyblue;
    top: 10px;
    left: 10px;
    width: 50px;
    height: 50px;
    transition: all 0.5s;
}
.hamburger-line {
  width: 35px;
  height: 5px;
  background-color: black;
  margin: 8.5px auto;
}
#hamburger:hover {
  opacity:0.8;
  cursor:pointer;
}
#sticky {
    background-color: white;
    position: fixed;
    top:0px;
    left:0px;
    width:50%;
    height:100%;
    transform: translate3d(-100vw, 0, 0);
    transition: all 0.5s;
    min-width:fit-content;
    z-index: 3
    }
#sticky img {
  width: 40vw;
  }
#close {
    display: block;
    position:relative;
    font-size:50px;
    top: 10px;
    left: 10px;
    width: 50px;
    height: 50px;
    background-color:black;
    color:white;
    text-align:center;
    line-height:50px;
    font-weight:bold;
    margin-bottom:20px;
}
#close:hover {
  cursor:pointer;
}
 }
</style>

<div>
<div id="hamburger" onclick="openNav()">
<div class="hamburger-line"></div>
<div class="hamburger-line"></div>
<div class="hamburger-line"></div>
</div>
</div>

<script>
function openNav() {
document.getElementById("sticky").style.transform = "translate3d(0, 0, 0)"
document.getElementById("hamburger").style.display = "none"
document.getElementById("background").style.display = "block"
}

function hideNav() {
document.getElementById("sticky").style.transform = "translate3d(-100vw, 0, 0)"
document.getElementById("hamburger").style.display = "block"
document.getElementById("background").style.display = "none"
}
</script>
  
<div id="sticky">
<div id="close" onclick="hideNav()">&times;</div>
<div style="display: inline-flex;vertical-align: bottom;"><img src="https://avatars.githubusercontent.com/u/98919050"/></div>
<a id="about" class="pages-button" href="/about">ABOUT</a>
<a id="projects" class="pages-button" href="/projects">PROJECTS</a>
<a id="blog" class="pages-button" href="/blog">BLOG</a>
<a id="contact" class="pages-button" href="/contact">CONTACT</a>
<div style="text-align:center">
<a href="https://www.facebook.com/torok.mark.werner" target="_blank" class="fa fa-facebook"></a>
<a href="mailto:torokmarkwerner@gmail.com" target="_blank" class="fa fa-google"></a>
<a href="https://www.linkedin.com/in/torok-mark-werner" target="_blank" class="fa fa-linkedin"></a>
  </div>
</div>

  <script>
//alert(document.location.pathname + " --> And this is the substring:" + document.location.pathname.toString().substring(1,document.location.pathname.toString().length-1))
pages = document.getElementsByClassName("pages-button");
for (i=0; i<pages.length; i++) {
  if(("/" + pages[i].textContent.toLowerCase() + "/") === document.location.pathname) {
    pages[i].classList.toggle("pages-button-current");
    pages[i].style.backgroundColor = "palegreen";
    pages[i].style.fontWeight = "bold"
  }
}
</script>

<div id="content-container">
<h1>D⁷ in Christmas songs</h1>
    <p>6 December 2022  | <span class="ert">
    <acronym title="Estimated reading time">ERT</acronym>:
    
    
    4 mins
</span></p>
<div style="margin-block-start: 1em;margin-block-end: 1em;">
    
    <div class="language"><a class="tag-name" style="color:black" href="/tag/en"><img src="https://upload.wikimedia.org/wikipedia/en/a/ae/Flag_of_the_United_Kingdom.svg" alt="EN" /></a></div>
    

  
  
    
    <div style="display:inline-block;padding: 0.5em 0;">[<a class="tag-name" href="/tag/christmas">CHRISTMAS</a>] </div>
  
    
    <div style="display:inline-block;padding: 0.5em 0;">[<a class="tag-name" href="/tag/guitar">GUITAR</a>] </div>
  
    
    <div style="display:inline-block;padding: 0.5em 0;">[<a class="tag-name" href="/tag/music">MUSIC</a>] </div>
  
    
    <div style="display:inline-block;padding: 0.5em 0;">[<a class="tag-name" href="/tag/chords">CHORDS</a>] </div>
  
</div>

<script src="/chord-player.js"></script>

<style>
sup {
  vertical-align: top;
  font-size: 0.6em
  }
.play, .chord {
  font-family: "Times New Roman";
  font-size: 100%;
  padding: 1em;
  margin: 0.5em;
  border:none;
  min-width: 5em;
  min-height: 3em
}
.play:hover, .chord:hover {
  cursor: pointer;
  opacity: 0.9;
}
.chord {
background-color: palegreen;
}
.play {
background-color:khaki;
}
.play:disabled, .chord:disabled {
  border: none;
  background-color: "";
  color: black;
}
</style>

<p>When it’s Christmas, it’s time for carolling.</p>

<p>It happened that I grabbed my guitar last Thursday to set the mood for December. I was checking out the guitar chords of some evergreens (yes, pun intended) when I noticed something strange. A chord kept coming up, regardless of what song I was strumming along: the mighty D<sup>7</sup>. No matter if it’s <a href="https://tabs.ultimate-guitar.com/tab/bing-crosby/white-christmas-chords-902543" target="_blank"><em>White Christmas</em></a>, <a href="https://tabs.ultimate-guitar.com/tab/casting-crowns/o-come-all-ye-faithful-chords-899101" target="_blank"><em>O Come All Ye Faithful</em></a>, or <a href="https://tabs.ultimate-guitar.com/tab/the-irish-rovers/we-wish-you-a-merry-christmas-chords-1009149" target="_blank"><em>We Wish You A Merry Christmas</em></a>, D<sup>7</sup> is apparently a must-have for yuletide composers.
<!--end-of-excerpt--></p>

<p><span class="highlighted-text">The rabbit hole of D<sup>7</sup> is an incredible place.</span> Once you start unravelling the mystery, new horizons show and memories come flooding back, memories of deadly boring solfège lessons. It seems D<sup>7</sup> isn’t the only thing these goldies have in common, they’re also written in the key of G with D<sup>7</sup> functioning as a dominant seventh.</p>

<div><img src="/assets/christmas-fireplace.jpg" /></div>

<div style="margin-block-start: 0.5em;margin-block-end: 0.5em;font-size: 80%;"><i>It's time to get yourself a mug of hot chocolate, pop some corn, and get comfortable in front of the fireplace.</i> Image: JillWellington (<a href="https://pixabay.com/photos/warm-and-cozy-popcorn-coffee-1975215" target="_blank">Pixabay</a>).</div>

<hr />

<h2 id="the-function-of-chords-in-a-key">The function of chords in a key</h2>

<p>What’s that gibberish? You may ask. Based on my research and my blurred memories from my early years of music education, songs are written in keys, meaning that they’re arranged with the help of pitches from a particular scale. For instance, the key of G (ie. the G major scale) consists of the following seven pitches: G, A, B, C, D, E, F#:</p>

<p><button class="play" onclick="playNotes(this,['G4', 'A4', 'B4', 'C5', 'D5', 'E5', 'F#5', 'G5'])">
▶
</button></p>

<p>OK, so now we have a key. The above pitches serve as the roots of the seven chords in the key of G, that is, the base pitch of the chord. These chords are assigned roman numbers (lowercase if it’s a minor chord), based on their place in the scale: I, ii, iii, IV, V etc. These numbers indicate the function of the given chord in the given key.</p>

<p>Chord progressions, or in other words, the way a song progresses from one chord to another, are based on these chord functions. One of the most frequent chord progressions is I-IV-V-I, which starts from the tonic (the chord established with the root of the key), goes to the subdominant, the fourth chord, culminates in the dominant, causing a great deal of tension, and finally, resolves in the tonic (also known as the home chord). That leaves us G-C-D-G in the key of G.</p>

<div>
<button class="play" onclick="playProgression(this)">▶</button>
<button class="chord" onclick="playChord(this)">G</button>
<button class="chord" onclick="playChord(this)">C</button>
<button class="chord" onclick="playChord(this)">D</button>
<button class="chord" onclick="playChord(this)">G</button>
</div>

<h2 id="the-dominant-seventh">The dominant seventh</h2>

<p>The dominant seventh is an alternative for the dominant chord, which causes a momentary ambiguity, a slight tension, as one of its notes is not in the scale. Let’s just take a look at D and D<sup>7</sup>, for example. D consists of D, F#, and A, while D<sup>7</sup> spices up the whole thing with the addition of C (a seventh note, hence the name), which gives the chord a touch of dissonance with a contrast between the third and the seventh, F# and C. Again, it’s mainly because C is not on a scale of D major, but it belongs to the relative minor (Dm).</p>

<div>
<button class="play" onclick="playProgression(this)">▶</button>
<button class="chord" onclick="playChord(this)">G</button>
<button class="chord" onclick="playChord(this)">C</button>
<button class="chord" onclick="playChord(this)">D<sup>7</sup></button>
<button class="chord" onclick="playChord(this)">G</button>
</div>

<p><span class="highlighted-text">That is why the application of the dominant seventh brings an uncanny feeling.</span> An unheimlich feeling if you will, truly in its Freudian sense, feeling of being at home, but not quite. Nostalgia might be another emotion that dominant sevenths evoke. It comes as no surprise that the root of the Greek word refers to a certain ‘homecoming pain’, in a broader sense, longing back for the past that’s lost forever, except for our memories.</p>

<p>Nonetheless, dominant seventh awake tension that needs resolution immediately. That’s why, more often than not, D<sup>7</sup> leads us back to G. If it is our home chord, the root, we’re alright set. But what if it isn’t our root? Then it is called tonicization, meaning that the chord calls for a tonic that is not the tonic of the key. For example, D<sup>7</sup> can be placed into a chord progression as the following: C F D<sup>7</sup> G. As soon as we start leaning towards that direction (ie. G), we are dealing with modulation and a different key than what we’ve started with.</p>

<p>Tonicization (in C):</p>
<div>
<button class="play" onclick="playProgression(this)">▶</button>
<button class="chord" onclick="playChord(this)">C</button>
<button class="chord" onclick="playChord(this)">F</button>
<button class="chord" onclick="playChord(this)">D<sup>7</sup></button>
<button class="chord" onclick="playChord(this)">G</button>
</div>

<p>Modulation (C → G):</p>
<div>
<button class="play" onclick="playProgression(this)">▶</button>
<button class="chord" onclick="playChord(this)">C</button>
<button class="chord" onclick="playChord(this)">F</button>
<button class="chord" onclick="playChord(this)">D<sup>7</sup></button>
<button class="chord" onclick="playChord(this)">G</button>
<button class="chord" onclick="playChord(this)">G<sup>7</sup></button>
<button class="chord" onclick="playChord(this)">C</button>
<button class="chord" onclick="playChord(this)">D</button>
<button class="chord" onclick="playChord(this)">G</button>
</div>

<p>All in all, D<sup>7</sup> is a dominant seventh that may function as a V<sup>7</sup> chord in a I IV V<sup>7</sup> I progression (as an ambiguous substitution for D), or it may resolve on another tonic (tonicization), possibly introducing a new key (modulation).</p>

<h2 id="the-dominant-sevenths-in-christmas-songs">The dominant sevenths in Christmas songs</h2>

<p>Huh. Now back to Christmas.</p>

<p>As established above, Christmas songs are often written in the key of G which is a go-to “happy” key, or the reason might just be that it is <a href="https://www.guitartricks.com/forum/t/5524?t=5524#:~:text=Most%20Christmas%20songs%20are%20played%20in%20the%20key%20of%20G%20on%20the%20guitar%2C" target="_blank">an “easy” key for guitarist</a> with most of its basic chords can be played as an open chord (except for F#dim), that is, as unbarred chords, chords without your finger pressing down the strings across the fingerboard.</p>

<p>Now, in the key of G, you can always have D or D<sup>7</sup> as a dominant, so it is quite obvious we have a lot of those around the house if it is a song written in G.</p>

<p>Why D<sup>7</sup> then?</p>

<div><img src="/assets/christmas-street-snowing.jpg" /></div>

<div style="margin-block-start: 0.5em;margin-block-end: 0.5em;font-size: 80%;"><i>These houses do not have a clue of the impending danger of D<sup>7</sup> chords invading the city.</i> Image: Couleur (<a href="https://pixabay.com/photos/christmas-lights-street-town-3834926" target="_blank">Pixabay</a>).</div>

<hr />

<p>Before we answer, let’s just take a detour to explore another honourable mention when it comes to christmassy chords.
It’s been 6 years since journalist <a href="https://www.youtube.com/watch?v=xm4LO22-cyY" target="_blank">Adam Ragusea figured out what the most christmassy chord is</a>, namely the Dm7b5. And in came musician <a href="https://www.youtube.com/watch?v=V5WfgMVtueo" target="_blank">Adam Neely to almost immediately debunk his theory</a>, interpreting the function of that god-awful transcription of a chord as one that, in that context, adds bittersweetness to the melody, as minor sevenths usually do.
Neely also indicates that it might be the roots of today’s popular Christmas songs where we should start investigating, as most of these songs (eg. <em>White Christmas</em>, <em>Have Yourself a Merry Little Christmas</em>) were written in an era where these bittersweet harmonies were quite popular in the US.</p>

<p>Likewise, D<sup>7</sup> might just be a jazzy alternative for D. On the other hand, it is arguably true that the dominant seventh evokes an even greater desire to resolve on the home chord. What if this what makes D<sup>7</sup>, G<sup>7</sup>, C<sup>7</sup>, B<sup>7</sup> etc. so ubiquitous in Christmas songs?</p>

<div>
<button class="play" onclick="playProgression(this)">▶</button>
<button class="chord" onclick="playChord(this)">G</button>
<button class="chord" onclick="playChord(this)">C</button>
<button class="chord" onclick="playChord(this)">D</button>
<button class="chord" onclick="playChord(this)">G</button>
</div>

<div>
<button class="play" onclick="playProgression(this)">▶</button>
<button class="chord" onclick="playChord(this)">G</button>
<button class="chord" onclick="playChord(this)">C</button>
<button class="chord" onclick="playChord(this)">D<sup>7</sup></button>
<button class="chord" onclick="playChord(this)">G</button>
</div>

<p>Causing tension that is always released the same way, <span class="highlighted-text">they’re chords that mirror our waiting for Christmas, the suspense before the overflow of joyous celebration with the family around the fireplace.</span></p>

<p>Similarly, remembering the long auld, almost forgotten Christmases evokes nostalgia, that is to say, it is Christmas but not that Christmas. D<sup>7</sup> is the chord of nostalgia in that it brings us nice memories just to take us back home with a bittersweet taste in our mouth.</p>

<p>Then again, it might just be Neely’s jazz thing. Who knows?</p>

<hr>

<div style="font-size:150%;font-weight:bold;font-variant:all-petite-caps;padding:5px 10px;">
  
    Comments
  
</div>

<script>
pages = document.getElementsByClassName("pages-button");
for (i=0; i<pages.length; i++) {
  if(("/" + pages[i].textContent.toLowerCase() + "/") === "/blog/") {
    pages[i].classList.toggle("pages-button-current");
    pages[i].style.backgroundColor = "palegreen";
    pages[i].style.fontWeight = "bold"
  }
}
</script>
<style>
.post-comment-number {
  font-size:110%;
  font-weight: bold;
  padding:1em;
}
.post-comment {
 clear:right;
 padding-left:1em;
 max-width:100%;
}
.post-comment-content, .post-comment-header, .reply-button-container {
  padding:1em
}
.post-comment-date {
  color:gray;
}
.post-comment-name {
  font-weight:bold;
  padding-right:0.5em;
}
.reply-button, .submit-button {
 border:none;
 background-color: antiquewhite;
 padding:0.6em;
 font-size: 90%;
 font-variant: all-petite-caps;
 cursor: pointer;
}
.reply-button:hover, .submit-button:hover {
 opacity:0.9
}
#comment-section input[type=text], textarea {
padding:0.5em;
font-family:inherit;
font-size:100%;
box-sizing: border-box;
}
#comment-section input[type=checkbox] {
min-height:20px;
min-width:20px
}
#comment-section label {
  font-size: clamp(0.5em, 2.5vw, 1.5em);
}
.comment-form-container {
  padding:1em 10% 1em 1em;
}
.leave-a-comment1:hover {
  text-decoration: underline;
  cursor:pointer;
  color:blue
}
</style>
<div id="comment-section">
<button id="recaptcha" style="display:none" class="g-recaptcha" data-sitekey="6Ld802sgAAAAABSZiOb1YDO0ApjEkmx4PNVh03tM" data-callback="onSubmit">
</button>
<div style="min-width:fit-content;max-width:50vw;padding-right:10%" id="demo">
</div>

<div id="leave-a-comment" style="padding: 0em 1em;font-size: 110%;font-weight: bold;">Leave a comment</div>
<div class="comment-form-container" style="min-width:fit-content;max-width:50vw;">
<table style="width:100%"><tbody>
<tr><td style="width:50%"><div style="width:100%"><input type="text" style="width:100%" placeholder="Name"></div></td><td style="width:50%"><div style="        display:flex;
        align-items:center;">
<input type="checkbox"><label>I <i>am</i> a robot.</label></div></td></tr>
<tr><td colspan="2"><textarea style="width:100%;height:15vh;resize:none" placeholder="Write your comment here"></textarea></td></tr>
<tr><td colspan="2"> <div style="display:flex;justify-content:flex-end;padding: 0.5em 1em 1em 0em;">
<button class="submit-button">
Submit
</button>
</div></td></tr>
 
  </tbody></table>
</div>
</div>
<script>
replyTo = ""
replyToName = ""
commenterNameData = "";
commenterCheckBoxcheckedData = "";
commenterCommentData = "";
  buttonData = document.getElementsByClassName("submit-button")[document.getElementsByClassName("submit-button").length-1];
  sampleForm =  document.createElement("DIV");
  sampleForm.innerHTML = '<table style="width:100%"><tbody><tr><td style="width:50%"><div style="width:100%"><input type="text" style="width:100%" placeholder="' + "Name" + '"></div></td><td style="width:50%"><div style=" display:flex; align-items:center;"><input type="checkbox"><label>' + "I <i>am</i> a robot." + '</label></div></td></tr><tr><td colspan="2"><textarea style="width:100%;height:15vh;resize:none" placeholder="' + "Write your comment here" + '"></textarea></td></tr><tr><td colspan="2"> <div style="display:flex;justify-content:flex-end;padding: 0.5em 1em 1em 0em;"><button class="submit-button">' + "Submit" + '</button></div></td></tr> </tbody></table>'

function submitButton(){
  document.getElementById("leave-a-comment").classList.add("leave-a-comment1");
 for (i=0; i<document.getElementsByClassName("submit-button").length; i++) {
   document.getElementsByClassName("submit-button")[i].addEventListener("click",function() {
     container = this.parentElement.parentElement.parentElement.parentElement.parentElement;
    //name	comment	link	recaptcha	reply-to	reply-to-name checked
     commenterNameData = encodeURIComponent(container.getElementsByTagName("input")[0].value);
     commenterCheckBoxcheckedData = container.getElementsByTagName("input")[1].checked
     commenterCommentData = encodeURIComponent(container.getElementsByTagName("textarea")[0].value);
     buttonData = this;
     if (commenterNameData && commenterCommentData && commenterCheckBoxcheckedData != true) {
     this.disabled = true;
     document.getElementById("recaptcha").click()
     }
                                                                                           });
 }
}

loadXMLDoc()
  
submitButton()
  
onSubmit = function(token){
  var xhttp = new XMLHttpRequest();
xhttp.open("POST", "https://script.google.com/macros/s/AKfycbzkFnl2gLfM7QlU_PHOCao5zMBX_rUZqx6_0jhgu-5fdg3juuNFHY0D_MrIa0TSXNDxwQ/exec", true);

xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
   //alert(xhttp.responseText)
       // Typical action to be performed when the document is ready:
       if (xhttp.responseText === "Successful submission") {
        buttonData.parentElement.parentElement.parentElement.parentElement.parentElement.innerHTML = "Thank you, your comment will be visible after approval."
       } else if (xhttp.responseText != "Successful submission") {
        buttonData.parentElement.parentElement.parentElement.parentElement.parentElement.innerHTML = "Something went wrong. Refresh the page and try again."       
       }
    }
};

xhttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
  
xhttp.send('name=' + commenterNameData + '&checked=' + commenterCheckBoxcheckedData + "&g-recaptcha-response=" + token + "&comment=" + commenterCommentData + "&link=" + window.location.href.split("#")[0] + "&reply-to=" + replyTo + "&reply-to-name=" + replyToName);
}
  
document.getElementById("leave-a-comment").addEventListener("click",function(){
  replyTo = ""
  replyToName = ""  
document.getElementById("leave-a-comment").classList.remove("leave-a-comment1");
  container = document.getElementsByClassName("comment-form-container")[document.getElementsByClassName("comment-form-container").length-1];
  if(container.innerText === "Thank you, your comment will be visible after approval.") {  
    container.innerHTML = ""
    sampleForm =  document.createElement("DIV");
    sampleForm.innerHTML = '<table style="width:100%"><tbody><tr><td style="width:50%"><div style="width:100%"><input type="text" style="width:100%" placeholder="' + "Name" + '"></div></td><td style="width:50%"><div style=" display:flex; align-items:center;"><input type="checkbox"><label>' + "I <i>am</i> a robot." + '</label></div></td></tr><tr><td colspan="2"><textarea style="width:100%;height:15vh;resize:none" placeholder="' + "Write your comment here" + '"></textarea></td></tr><tr><td colspan="2"> <div style="display:flex;justify-content:flex-end;padding: 0.5em 1em 1em 0em;"><button class="submit-button">' + "Submit" + '</button></div></td></tr> </tbody></table>'
  container.appendChild(sampleForm)
  }
  container.style.display = "block"
submitButton();

 for (i=0; i<replyButtons.length; i++) {
     replyButtons[i].parentElement.style.display = "flex"
     replyButtons[i].style.display = "block"
     if (replyButtons[i].nextElementSibling) {
     replyButtons[i].nextElementSibling.remove()
     }
     }
     
});

function loadXMLDoc() {
 var xhttp = new XMLHttpRequest();
 xhttp.onreadystatechange = function() {
   if (this.readyState == 4 && this.status == 200) {
     
     posts = []
     columns = this.responseText.split("\r\n")[0].split(",").length; //For possible future purposes.
     data = this.responseText.split("\r\n");
     
     
     for (i=0; i<data.length; i++) {
     if (data[i].split(",")[3] === window.location.href.split("#")[0] && data[i].split(",")[8] === "1") {
     postObject = {
     "date":data[i].split(",")[0],
     "name":data[i].split(",")[1],
     "comment":data[i].split(",")[2],
     "link":data[i].split(",")[3],
     "recaptcha":data[i].split(",")[4],
     "post-id":data[i].split(",")[5],
     "reply-to":data[i].split(",")[6],
     "reply-to-name":data[i].split(",")[7],
     "moderated":data[i].split(",")[8]
     }
     posts.push(postObject)
     }
     }
   
     numCom = posts.length;
     postCommentNumber = document.createElement("DIV");
     if (numCom<2) {postCommentNumber.innerHTML = numCom + " comment"} else {postCommentNumber.innerHTML = numCom + " comments"};
     postCommentNumber.className = "post-comment-number"
     document.getElementById("demo").prepend(postCommentNumber);
     
     for (i=0;i<posts.length;i++) {
     commentBody = document.createElement("DIV");
     commentBody.setAttribute("id",posts[i]["post-id"]);
     
     header = document.createElement("DIV");
     header.className = "post-comment-header"
commenterName = document.createElement("SPAN");
commenterName.className = "post-comment-name"
commenterName.innerText = posts[i].name;
date = document.createElement("SPAN");
date.className = "post-comment-date"
date.innerText = posts[i].date;
header.appendChild(commenterName);
header.appendChild(date);

comment = document.createElement("DIV");
if (posts[i]["reply-to"] === "") {
comment.innerText = decodeURIComponent(posts[i].comment);
} else {
comment.innerHTML = "<a href='#" + posts[i]["reply-to"] + "'>@" + posts[i]["reply-to-name"] + "</a> " + decodeURIComponent(posts[i].comment);
}
comment.style.backgroundColor = "lightgoldenrodyellow";
comment.className = "post-comment-content"

replyDiv = document.createElement("DIV");
replyDiv.style.display = "flex";
replyDiv.style.justifyContent = "flex-end"
replyDiv.className = "reply-button-container"

reply = document.createElement("BUTTON");
reply.className = "reply-button";
reply.innerText = "Reply";
replyDiv.appendChild(reply)

commentBody.className = "post-comment";

commentBody.appendChild(header)
commentBody.appendChild(comment)
commentBody.appendChild(replyDiv)

document.getElementById("demo").appendChild(commentBody)
     }
     
     
     replyButtons = document.getElementsByClassName("reply-button");
     for (i=0; i<replyButtons.length; i++) {
     replyButtons[i].addEventListener("click",function(){
     replyTo = this.parentElement.parentElement.id
     replyToName = encodeURIComponent(this.parentElement.parentElement.children[0].children[0].innerText)
     document.getElementById("leave-a-comment").classList.add("leave-a-comment1");
     for (i=0; i<replyButtons.length; i++) {
     replyButtons[i].parentElement.style.display = "flex"
     replyButtons[i].style.display = "block"
     if (replyButtons[i].nextElementSibling) {
     replyButtons[i].nextElementSibling.remove()
     }
     }
     this.style.display = "none";
     document.getElementsByClassName("comment-form-container")[document.getElementsByClassName("comment-form-container").length-1].style.display = "block"
     document.getElementsByClassName("comment-form-container")[document.getElementsByClassName("comment-form-container").length-1].style.display = "none"
  
     this.parentElement.style.display = "block";
         sampleForm =  document.createElement("DIV");
         sampleForm.innerHTML = '<table style="width:100%"><tbody><tr><td style="width:50%"><div style="width:100%"><input type="text" style="width:100%" placeholder="' + "Name" + '"></div></td><td style="width:50%"><div style=" display:flex; align-items:center;"><input type="checkbox"><label>' + "I <i>am</i> a robot." + '</label></div></td></tr><tr><td colspan="2"><textarea style="width:100%;height:15vh;resize:none" placeholder="' + "Write your comment here" + '"></textarea></td></tr><tr><td colspan="2"> <div style="display:flex;justify-content:flex-end;padding: 0.5em 1em 1em 0em;"><button class="submit-button">' + "Submit" + '</button></div></td></tr> </tbody></table>'
       //alert(sampleForm.innerHTML)
     this.parentElement.appendChild(sampleForm)
      
       
     submitButton();
     })
     }
     //document.getElementById("demo").innerHTML = JSON.stringify(posts)
   }
 };
 xhttp.open("GET", "https://docs.google.com/spreadsheets/d/e/2PACX-1vQg6dmeH1EYHwCm1zLmGSI34IC9Uchtf8pWL3KfqnPIMbSbFl-DB1jptcCjuIlP3e4mRVmcG7PbGuGz/pub?gid=0&single=true&output=csv", true);
 xhttp.send();
}
</script>
<hr>
<style>
  .related-post-title-container {
    position:absolute;
    z-index:2;
    padding:0.5em 1em;
    bottom:0.5em;
    font-variant-caps:all-small-caps;
    text-align:center;
    font-size:110%;
    background-color: #ffff9a;
    width:calc(80% - 2em);
  }
  .related-post-title-container a {
    color:black;
    text-decoration:none;
  }
  .related-post-title-container a:hover {
    cursor:pointer;
   font-weight:bold;
  }

    .related-post-image {
     z-index:1;
     max-width: 80%;
     padding: 5px 0;
    }
@media (max-width: 767px) {
    .related-post-image {
     padding: 5px 0;
    }
    }
.related-post-image:hover {
 cursor:pointer;
 opacity:0.8
}
</style>
<!--
<div>
  <div style="font-size: 150%;font-weight: bold;font-variant: all-petite-caps;padding: 5px 10px;max-width:80%">Related Posts</div>
  <div style="padding-bottom: 22px;width:80%">
    
    <div style="position:relative">
    <div class="related-post-title-container">
                <a href="/2023/05/25/the-hooded-crow-the-pigeon-and-the-trash-can.html">The Hooded Crow, The Pigeon, and the Trash Can</a></div>
      <div>
        <a href="/2023/05/25/the-hooded-crow-the-pigeon-and-the-trash-can.html"><img class="related-post-image"
                     src="/assets/Europe_2022_MRD_Corvids.png"></a></div>
    </div>
    
    <div style="position:relative">
    <div class="related-post-title-container">
                <a href="/2022/12/23/van-helsing.html">Oh The Movies | Van Helsing (2004)</a></div>
      <div>
        <a href="/2022/12/23/van-helsing.html"><img class="related-post-image"
                     src="/assets/van-helsing.jpg"></a></div>
    </div>
    
    <div style="position:relative">
    <div class="related-post-title-container">
                <a href="/2022/12/23/old-people.html">Oh The Movies | Old People (2022)</a></div>
      <div>
        <a href="/2022/12/23/old-people.html"><img class="related-post-image"
                     src="/assets/old-people.jpg"></a></div>
    </div>
    
  </div>
</div>
-->

</div>

</div>

</body>

</html>
