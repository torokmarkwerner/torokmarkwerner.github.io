<script src="https://www.google.com/recaptcha/api.js" async defer></script>

<form id='demo-form' >
        Name: <input class="required-fields" id="name" type="text" name="name" required><br>
      Email: <input class="required-fields" id="email" type="text" name="name" required><br>
      Message: <input class="required-fields" id="message" type="text" name="name" required><br>

<button class="g-recaptcha" 
        data-sitekey="6Ld802sgAAAAABSZiOb1YDO0ApjEkmx4PNVh03tM" 
        data-callback='onSubmit'>SEND</button>
        </form>

<script>
onSubmit = function(token) {
        alert(token)
var xhttp = new XMLHttpRequest();
xhttp.open("POST", "https://script.google.com/macros/s/AKfycbxCcYzGfxqpEruWnrNDr6qylHfieOde_rN7ijpUaY2xXgNqODl21t6DtwTzOjSxNHW-pQ/exec", true);

xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
       // Typical action to be performed when the document is ready:
       if (xhttp.responseText === "GOOD") {
        document.getElementById("demo-form").innerHTML = "<div>Your message has been sent. It will be answered soon.</div>"       
       } else {
        document.getElementById("demo-form").innerHTML = "<div>Something went wrong. Try again.</div>"       
       }
    }
};

xhttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
         xhttp.send('name=' + document.getElementById("name").value + "&g-recaptcha-response=" + token + "&email=" + document.getElementById("email").value + "&message=" + document.getElementById("message").value);
}
</script>
